CC=@CC@
IHKBASE ?= @abs_srcdir@/../..
CFLAGS=-Wall -O -I$(IHKBASE)/linux/include/
SBINDIR=@SBINDIR@
MANDIR=@MANDIR@
VPATH=@abs_srcdir@
TARGET=ihkconfig ihkosctl memdump pagetable maccess memdump-mic
#TARGET+=ihkosdump eclair

.PHONY: all clean install

all: $(TARGET)

clean:
	$(RM) $(TARGET) *.o

ihkosdump: ihkosdump.c
	${CC} ${CFLAGS} -o $@ $< -lbfd

eclair: eclair.c
	${CC} ${CFLAGS} -o $@ $< -lbfd

install:
	mkdir -p -m 755 $(SBINDIR)
	install -m 755 ihkconfig $(SBINDIR)/ihkconfig
	install -m 755 ihkosctl $(SBINDIR)/ihkosctl
	mkdir -p -m 755 $(MANDIR)/man1
	install -m 644 ihkconfig.1 $(MANDIR)/man1/ihkconfig.1
	install -m 644 ihkosctl.1 $(MANDIR)/man1/ihkosctl.1
